# Learn HTTP

    ff
    2017-08-20

作为一个半路出家的前端工作人员，深感对于计算机编程基础的缺失是一件限制自身发展的重要因素。它限制了我对一些基础知识的理解和接受的能力，所以我z决定从 HTTP 方面开始入手，来补充自己对于行业基础知识的缺失；  

在学习这些方面的知识时，切忌由于看不到实际收益而产生浮躁的心情 -- 送与自己

## 了解 Web 及网络基础

    本章主要介绍了关于 Web 的一些基础知识

### 1 使用 HTTP 协议访问 Web

1. Web 页面是如何呈现的

    访问一个页面就是读取一台电脑上面的信息，最基础的是需要有一个请求页面行为，和一个返回页面的行为；
    当我们在浏览器中输入 URL 后，我们的电脑就会产生一个**请求的行为**，会把请求的信息发送到某处；而作为接收方，在接受到请求信息的时候，就会查找相应的信息，并将其**返回**到发起请求的电脑上，于是我们才能够看到真实的页面；

    像这种通过向制定地址发送请求获取（或者上传）服务端资源的 Web 浏览器（或其他工具）都可以统称为**客户端**，而服务器就是对客户端行为进行相应反馈的一方；

2. HTTP

    我们通过上面的示例，可以看到一次请求的行为是十分直接的，由客户端发出请求然后通过服务端将请求数据返回，客户端接受到返回的数据，并进行相应操作；
    但是其中我们还需要面临很多问题，

    - 例如：
        1. 我们应该以什么样的方式去发送什么样格式的请求；
        2. 而服务端返回数据又应该遵循什么样的标准；
        3. 并且客户端又应该如何去接受到服务端的数据；
        4. 地址从哪里来；
        ……
    
    这是就需要引入 HTTP 协议了；

    HTTP 协议是完成从客户端到服务端等一系列运作的流程中需要遵守的约定，可以说是 Web 是建立在 HTTP 协议上通讯的；

    - 注：
        HTTP （HyperText Transfer Protocol） 协议又叫做超文本传输协议；

### 2 HTTP 的历史

1. 当初电脑之间相互独立，并不存在网络页面；然后有人就想让身处不同地方的人可以共同学习；最初的设想就是通过借助文档之间的相互关联形成的超文本（1），连成可以相互参阅的 WWW（2）

2. Web 成长时代
    - 1990 年，世界上第一台 Web 服务器和 第一个 Web 浏览器诞生；在 1993 年的时候现代浏览器的祖先诞生了，然后不久就发生了了浏览器大战（网景和微软）；
    - HTML 1.0 迅速被抛弃，HTML 2.0 成为标准
    - Apache 成为服务端标准之一

3. 驻足不前的 HTTP
    HTTP 协议作为 Web 文档传输的标准，它的版本基本上没有发生什么变化，HTTP／1.1 是目前的主流，HTTP／1.0 仍然被广泛的使用在服务端；  
    HTTP 最初的目的是为了解决文本传输的难题，但是由于其本身非常简单，于是在此基础上又建设了很多应用方法，并且投入了使用；目前 HTTP 协议已经超出了 Web 的框架，被广泛的应用到了各种场景中；

- 注：
    超文本：用超链接的方法，将各种不同空间的文字信息组织在一起的网状文本；
    WWW：环球信息网，是由多个相互连接的超文本组成的系统，它允许客户端可以访问服务的页面；也可以简称为 Web；

### 3. 网络基础 TCP／IP

通常使用的网络是在 TCP／IP 协议族的基础上运作的，而 HTTP 协议属于它的一个子集；

1. TCP／IP 协议族

    我们可以推论到如果一个计算机和网络设备之间要相互通讯，那么双方就需要基于相同的规则，而在整个通讯的过程中，存在着各种各样的规则，我们将这些规则称为协议，而这些规则的集合总称为 TCP／IP 

2. TCP／IP 的分层管理

    TCP／IP 包含着各种协议，如果按照层次进行划分，可以分为：应用层  传输层  网络层 和 数据传输层；

    - 应用层
        应用层向用户提供了一组常用的应用程序，决定了向用户提供应用服务时通信的行为，应用层直接和应用程序接口并提供常见的网络应用服务。
        在 TCP／IP 中预存了各类通用的应用服务，比如 FTP （文件传输协议）以及 DNS（域名系统）就是其中的两种，而且 HTTP 协议也属于该层；
    
    - 传输层
        传输层服务于应用层，向其提供网络连接中两台计算机之间的数据传输；
        在传输层存在两个性质不同的协议，TCP（传输控制协议）以及 UDP（用户数据报协议）；
    
    - 网络层
        网络层用来处理在网络上流动的数据包，数据包是网络传输的最小数据单位，该层规定了通过怎样的路径到达对方的计算机，并将数据包传送给对方；
        当与对方计算机之间通过多台计算机活着网络设备进行传输的时候，网络层起的作用就是在多条传输路线中选择一条；
    
    - 链路层
        用来处理链接网络的硬件部分；
    
3. TCP／IP 通讯传输流

    通过 TCP／IP 协议族进行网络通讯时，会通过分层顺序与对方进行通讯；
    以 HTTP 为例流程大致如下；

    1. 首先客户端在应用层（HTTP 协议）发出一个想看某个 Web 页面的 HTTP 请求；
    2. 为了方便传输，在传输层（TCP 协议）将从应用层收到的数据（HTTP 请求报文）进行分割，并在各个报文上标记需要以及端口号后转发给网络层
    3. 在网络层（IP 协议）增加作为通信目的地的 MAC 地址后转发给链路层。通讯请求可以发送
    接受端，在链路层接受到数据，然后 => 网络层 => 传输层 => 应用层 服务端接收到 HTTP 请求

4. 与 HTTP 关系密切的协议：IP/TCP/DNS

    1. IP 协议
        IP 属于网络层，负责将数据包传送给对方；而要确保将数据传送给对方，需要具有两个重要的条件：1. IP 地址 2. MAC 地址
        IP 地址是指节点被分配到的地址，而 MAC 地址则是网卡所属的固定地址，IP 地址可以和 MAC 地址进行配对，并且 IP 地址可以变换，而 MAC 地址则基本上不会发生变化；
    
    2. ARP 协议
        一般情况下，在统一局域网中直接访问的行为比较少见，常见的是通过多台计算机活着网络设备中转来链接到对方；而在中转时，我们需要知道下一站的地址，而 ARP 协议就是一种用于解析地址的协议，可以根据通信方的 IP 地址就可以反查出对应的 MAC 地址，或者通过设备的 MAC 地址反查出对应的 IP 地址；
        在到达通讯目标前的中专过程中，那些计算机和路由器等网络设备只能获得部分的传输路线，这种机制被称为路由选择；没有哪一台设备可以获知整个传输的细节；

    3. 确保可靠的 TCP 协议
        TCP 属于传输层，提供可靠的字节流服务（将大数据分割，并且确认数据是否送达到对方）
        字节流服务是指：为了方便传输，将大块的数据分割成以报文段为单位的数据包进行管理；

        - 如何确保数据能够送达目标
            为了确保数据能够送到目标处，TCP 协议采用了三次握手的策略；用 TCP 协议将数据包发送出去后，它会向对方确认是否已经成功送达，在握手的过程中使用 TCP 的标示 -- SYN 和 ACK；如果在握手的过程中某个阶段莫名终端，TCP 协议会再次以相同的顺序发送相同的数据包；

        - 三次握手
            1. TCP 协议将标有 SYN 标示的数据包发送给接受端，并等待接受端返回信息
            2. 接受端返回已经接受到信息的数据包（带有 SYN/ACK）
            3. TCP 协议得到服务端的信息，并返回确认信息和具有 ACK 标示的数据包
        
        除了上述的三次握手外，TCP 协议还有其他手段来确保通信的可靠性
    
    4. 负责域名解析的 DNS 服务
        DNS 服务时和 HTTP 协议一样位于应用层的协议，它提供域名到 IP 地址之间的解析服务；
        计算机既可以被赋予 IP 地址，也可以被赋予主机名和域名，比如： www.baidu.com；
        前面也介绍了，在请求过程中，需要知道对方的 IP 地址（IP 协议）；但是 IP 地址是由一串纯数字组成的地址，并不利于记忆和使用，但是如果直接使用单词作为地址信息，计算机又不能理解。为了解决上述问题，DNS 服务应运而生，DNS 协议提供了通过域名查找 IP 地址，或者逆向从 IP 地址查找到域名的服务；  
        当你在地址栏中输入域名来进行访问的时候，这个域名将会先通过 DNS 进行解析，解析成 IP 地址后，再去对服务端发送请求

    5. 各种协议与 HTTP 之间的关系
        在经过上面的介绍后，我们缕一缕在一个 HTTP 请求的过程中发生了哪些行为；

        以客户端希望浏览一个域名为 `http://www.baidu.com` 的页面开始

        1. 客户端将域名信息发送给 DNS 进行解析，DNS 返回域名对应的 IP 地址
        2. HTTP 协议生成目标 Web 服务器的 HTTP 请求报文；（应用层）
        3. TCP 协议 为了方便数据传输，将 HTTP 请求报文分割称为报文段，并且将每一个报文可靠的传输给对方
        4. IP 协议 搜索对方地址（MAC & IP）一边中转一边传送
        5. 服务端：TCP 协议 介绍对方传输来的报文段，然后重组
        6. HTTP 协议 解析报文段，获取对方的目的，对 Web 客户端请求的内容进行处理；
        7. 对请求的结果同样利用 TCP/IP 的通讯协议进行回传

5. URI 和 URL

    URI -- 统一资源标识符
    URL -- 统一资源定位符 （也是我们在浏览器访问页面时需要输入的访问地址）

    1. URI
        U -- Uniform
        统一格式
        R -- Resource
        资源
        I -- Identifier
        表示可标示的对象

        URI 就是有某个**协议方案（1）**表示的资源的标识符，使用字符串来表示某一互联网资源，而 URL 表示资源互联网上所处的位置；**URL 时 URI 的一个子集**

    - 注：
        协议方案是指访问资源所使用的协议类型的名称（比如：http／ftp／file）
    
    2. URI 格式

        表示指定的 URI 需要包含：绝对 URI 绝对 URL 相对 URL
        示例：
            `http://user:pass@www.example.jp:80/dir/index.html?uid=1#ch1`
        
        解释：

        - `http://` -- 协议的方案名
            使用协议方案名来获取访问资源时要制定的协议类型，不区分大小写；
        - `user:pass` -- 登陆信息（认证）
            身份认证（用户名和密码）可选
        - `www.example.jp` -- 服务端地址
            可以时域名，IPv4 或者 IPv6
        - `:80` 服务器端口号，可选不填写使用默认端口
        - `/dir/index.html` -- 带层次的文件路径
            制定资源位置
        - `?uid=1` -- 查询字符串
            针对已经指定的文件路径内的资源，可以使用查询字符串传入任意参数（可选）
        - `#ch1` -- 片段标识符（hash）
            使用片段标识符通常可以标记出已获取资源中的子资源（文档中的某个位置）在 RFC 中没有明确表示其的使用方法（可选）

6. RFC 
    有一些用来制定 HTTP 协议技术标准的文档，它们被称为 RFC
    通常来说应用程序需要遵循 RFC 来制定标准实现，这样在不同的设备上可以相互访问，但是也是存在一些没有使用 RFC 标准去实现 HTTP 协议的，对于这些行为，据需要其他的客户端和服务区去适应它，除了一些特殊情况，使用自己标准来实现 HTTP 的行为是得不偿失的；这里介绍的内容都是遵循 RFC 标准的。



